Recognizer: O(N^2) (need proof)
Tree construction: O(N^3)
